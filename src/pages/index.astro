---
import Layout from '../layouts/Default.astro';
import BigButton from '../components/BigButton.astro';
import { getPageInfo } from '../scripts/astro-helpers';

// Layout variables
const pageInfo = getPageInfo({
	titleAppend: '3D art and programming',
	tab: 'home'
});
---

<Layout pageInfo={pageInfo}>
	<div class="homepage">
		<h1 class="homepage-title">Jan Bl√°ha</h1>
		<div class="model-viewer-container">
			<model-viewer
				environment-image="/assets/env.hdr"
				exposure="1.1"
				autoplay
				disable-pan
				disable-zoom
				min-camera-orbit="auto 80deg auto"
				max-camera-orbit="auto 80deg auto"
				shadow-intensity="1"
				shadow-softness="0"
				tone-mapping="aces"
				onload="fadeIn(this)"
				camera-controls
				touch-action="pan-y"
				interaction-prompt="none"
				auto-rotate
				auto-rotate-delay="0"
				rotation-per-second="-5deg"
			/>
		</div>
		<div class="homepage-info-panel">
			<div class="typewriter-container">
				<div id="typewriter-history"></div>
				<div id="typewriter">_</div>
			</div>
			<div class="projects-button-wrapper">
				<BigButton
					text="View projects"
					link="/projects/"
					icon="/assets/svg/folder-open.svg"
				/>
			</div>
		</div>
	</div>
</Layout>

<script>
	import '@google/model-viewer';
	import '../scripts/client/model-viewer.js';
	import '../scripts/client/model-viewer-homepage.js';
	import '../scripts/client/typewriter.js';
</script>

<style>
	.homepage {
		min-height: 420px;
		margin: auto;
		height: 100%;
		display: flex;
		flex-direction: column;
		justify-content: center;
	}

	.homepage-title {
		z-index: -10;
		font-size: 60px;
		text-align: center;
		pointer-events: none;
	}

	.model-viewer-container {
		position: absolute;
		top: 64px;
		bottom: 0;
		left: -260px;
		width: calc(100% + 260px);
	}

	.homepage-info-panel {
		height: 100%;
		margin-left: 52%;
		display: flex;
		flex-direction: column;
		justify-content: center;
	}
	
	.projects-button-wrapper {
		margin: 20px 0px;
	}

	.typewriter-container {
		z-index: 10;
		pointer-events: none;
		user-select: none;
	}

	#typewriter-history :global(div),
	#typewriter {
		z-index: 10;
		font-size: 30px;
		white-space: nowrap;
	}

	#typewriter-history {
		height: 0px;
		display: flex;
		flex-direction: column;
		justify-content: flex-end;
	}

	@media (max-width: 776px) {
		.homepage {
			position: relative;
		}

		.homepage-title {
			font-size: 56px;
			margin-bottom: 0;
		}

		.model-viewer-container {
			left: 0;
			width: 100%;
			bottom: 0;
			top: 30px;
			height: auto;
		}

		.homepage-info-panel {
			margin-left: 0px;
			align-items: center;
			justify-content: end;
		}
		
		.projects-button-wrapper {
			margin: 10px;
		}

		.typewriter-container {
			display: none;
		}
	}
	
	@media (min-width: 2100px) {
		.homepage-info-panel {
			margin-left: 53%;
		}

		.model-viewer-container {
			left: -300px;
			width: calc(100% + 300px);
		}
	}
</style>

<style is:global>
	#model-debug {
		position: absolute;
		opacity: 0;
		width: 100%;
		bottom: 110px;
		pointer-events: none;
		display: flex;
		justify-content: center;
		animation: modelDebugReveal 0.7s cubic-bezier(0.175, 0.885, 0.32, 1.0) forwards;
	}

	.model-debug-list {
		display: flex;
		padding: 5px 8px;
		border-radius: 3px;
		background: #0002;
		border-radius: 500px;
	}

	.model-debug-item {
		display: flex;
		width: 28px;
		height: 26px;
		font-size: 17px;
		border-radius: 500px;
		justify-content: center;
		align-items: center;
		color: #333;
		padding: 6px;
		margin: 3px;
		pointer-events: all;
		cursor: pointer;
	}

	@keyframes modelDebugReveal {
		from {
			bottom: 110px;
			opacity: 0;
		}
		to {
			bottom: 130px;
			opacity: 1;
		}
	}
</style>