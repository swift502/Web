---
import { logError } from "../scripts/astro-helpers.js";
import FrameView from "../components/project_detail/FrameView.astro";
import type { ContentBlockData, SketchfabProperties } from "../scripts/interfaces.js";

interface Props extends ContentBlockData<SketchfabProperties> {}
const { project, contentBlock } = Astro.props;

function getSourceUrl()
{
	if ('model' in contentBlock.properties)
	{
		return `https://sketchfab.com/models/${contentBlock.properties.model}/embed`;
	}
	else if ('collection' in contentBlock.properties)
	{
		return `https://sketchfab.com/playlists/embed?collection=${contentBlock.properties.collection}`;
	}
	else
	{
		logError(`Source was not defined for content block index "${contentBlock.index}"`);
		return "";
	}
}

---

<FrameView
	project={project}
	contentBlock={contentBlock}
	width="16"
	height="9"
>
	<iframe
		src={getSourceUrl()}
		title="Sketchfab viewer"
		allowfullscreen
		allow="autoplay; fullscreen; xr-spatial-tracking"
		xr-spatial-tracking
		execution-while-out-of-viewport
		execution-while-not-rendered
		web-share
		onload="fadeIn(this);"
	/>
</FrameView>

<style>
	iframe {
		opacity: 0;
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
	}
</style>